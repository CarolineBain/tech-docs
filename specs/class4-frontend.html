<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Class 4 dynamic web interface</title>
    <link rel="stylesheet" href="reset.css" media="all">
    <script src="script.js" charset="utf-8"></script>
</head>
<body>
    <h1>Class 4 front-end technical specification</h1>
    <div id="toc"></div>
    <h2>Introduction</h2>
    <p>The existing front-end for Class 4 statistics is not scalable. As
    additional menu options are added the time required to generate the
    extra plots grows super-linearly. This scaling is a direct result
    of the system's architecture. The decision was taken early on to serve
    pre-computed static images. Initially, this seemed like a good idea
    since it was simple to implement and could quickly visualise results. But
    over time the limitations of this approach have been exposed. A more
    scalable solution, although not a panacea, would be to allow a user
    to dynamically generate images.</p>
    <p>The approach taken here is to leverage web standards and
    JavaScript visualisation libraries to craft a dynamic and interactive
    user experience. Different technical challenges exist with this
    approach, such as converting SVG to PNG without a dedicated server,
    but overall the benefits greatly outweigh the drawbacks
    of the existing system.</p>
    <h2>Overview</h2>
    <p>Exploring ocean verification results at present requires the user to
    repeatedly generate static images from NetCDF files using a relatively
    complicated command line tool called c4plot.
    To isolate a particular issue, the user must iteratively re-run c4plot
    using more and more precise arguments to bisect the affected
    dates.</p>
    <p>A more desirable solution would be for the user to click/zoom to the
    affected portion of the time series without having to re-generate images. Indeed,
    the user should not even need access to the underlying files to be able to
    explore the data. The front-end should re-render the desired data dynamically.</p>
    <p>The present system serves two uses. It is both a monitoring tool and a tool to track
    our performance relative to other forecasting centers. However, since it
    can only generate static images it cannot simultaneously display both
    a high-level and low-level view of the data. The proposed solution aims to
    unify these use cases by providing the user with an interface adapted for
    both diagnosis and long term summarisation.</p>
    <h2>Current system</h2>
    <img src="images/current-flow.gif" alt="" />
    <p>The workflow under the current system involves a user (with access
    to statistics files) either plotting a vast number of images
    or when diagnosing a particular issue iteratively re-plotting static
    images from the command line. The web site is solely a menu system for
    navigating to particular images. It has no ability to generate images
    if the desired image is not available.</p>

    <h3>Labour intensive data exploration</h3>
    <p>Data exploration with c4plot is time consuming. Under the current
    system to find a date related to a spike, a user must regenerate
    plots with shorter and shorter time intervals until the x-axis
    labels resolve the date. A JavaScript approach would simply show
    a tooltip on hover with the date information. The c4plot system
    also requires the user to restore the original image after the
    data exploration has completed, if the website is viewable by other
    users.</p>

    <h3>Combinatorial explosion of plots</h3>
    <p>While having one or two metrics displayed for a handful of regions is
    super light-weight and lightning fast. Turning on all bells and whistles
    can quickly result in the generation of several million plots. Of which,
    inevitably the plot needed to diagnose a problem will not be present.</p>
    <h3>User driven plotting</h3>
    <p>More and more, users of the data are requesting that plots be generated
    in a bespoke manner. Individually, these requests seem sensible. But
    aggregated over half a dozen users it becomes difficult to service their
    requests. A tool is needed to generate bespoke plots on a per-user basis
    without a need for manual intervention from the site-owner.</p>
    <h2>Proposed system</h2>
    <img src="images/future-flow.gif" alt="" />
    <p>By eliminating interaction with the command line, the replacement tool should
    make it easier to diagnose issues affecting one or more ocean models. Instead
    of running a command line tool and refreshing their browser, a user can
    simply click on a checkbox and display particular trends of interest.
    </p>
        <h3>Features</h3>
        <ul>
            <li>Add/remove individual lines</li>
            <li>Pan/zoom to spike of interest</li>
            <li>Reveal using tooltips the values of particular data points</li>
            <li>Assign colors using a helpful tooltip</li>
            <li>Save SVG elements to PNG</li>
            <li>Reproduce plot state from URL hash</li>
        </ul>
        <h3>Dependencies</h3>
        <ul>
            <li>d3.js</li>
        </ul>
        <p>The only hard dependency of this proposed tool is to leverage
        a JavaScript library called d3.js to do the heavy lifting when it
        comes to svg element rendering.</p>
        <h3>Issues</h3>
        <p>The above proposal has been technically feasible for many years
        but has never been considered as a viable solution since there
        was a requirement to have publication PNG images readily available.</p>
    <h2>Summary</h2>
    <p>The existing solution while functional is not scalable</p>
</body>
</html>
